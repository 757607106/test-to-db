# Chat-to-DB å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“‹ å‰ææ¡ä»¶

- Docker å’Œ Docker Compose å·²å®‰è£…
- Python 3.11+ å·²å®‰è£…
- Node.js 18+ å·²å®‰è£…

---

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. å¯åŠ¨ Docker æœåŠ¡

```bash
# å¯åŠ¨æ ¸å¿ƒæœåŠ¡ï¼ˆMySQL + PostgreSQLï¼‰
./start-services.sh start

# ç­‰å¾…æœåŠ¡å¯åŠ¨ï¼ˆçº¦ 10 ç§’ï¼‰
sleep 10

# éªŒè¯æœåŠ¡çŠ¶æ€
./start-services.sh status
```

### 2. è¿è¡Œæ•°æ®åº“è¿ç§»

âš ï¸ **é¦–æ¬¡å¯åŠ¨å¿…é¡»æ‰§è¡Œæ­¤æ­¥éª¤**

```bash
cd backend
alembic upgrade head
cd ..
```

### 3. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
pip install -r requirements.txt

# å¯åŠ¨ç®¡ç†åå°æœåŠ¡ï¼ˆç«¯å£ 8000ï¼‰
python admin_server.py

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨èŠå¤©æœåŠ¡ï¼ˆç«¯å£ 8001ï¼‰
python chat_server.py
```

### 4. å¯åŠ¨å‰ç«¯æœåŠ¡

#### ç®¡ç†åå°

```bash
cd frontend/admin

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç«¯å£ 3000ï¼‰
npm start
```

#### èŠå¤©ç•Œé¢

```bash
cd frontend/chat

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç«¯å£ 3001ï¼‰
npm run dev
```

---

## ğŸ” éªŒè¯å®‰è£…

### æ£€æŸ¥ Docker æœåŠ¡

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | grep chat_to_db_rwx

# åº”è¯¥çœ‹åˆ°ï¼š
# chat_to_db_rwx-mysql
# chat_to_db_rwx-postgres-checkpointer
```

### æ£€æŸ¥æ•°æ®åº“è¿æ¥

```bash
# æµ‹è¯• MySQL
docker exec -it chat_to_db_rwx-mysql mysql -uroot -pmysql -e "SHOW DATABASES;"

# æµ‹è¯• PostgreSQL
docker exec -it chat_to_db_rwx-postgres-checkpointer psql -U langgraph -d langgraph_checkpoints -c "SELECT 1;"
```

### æ£€æŸ¥åç«¯ API

```bash
# æµ‹è¯•ç®¡ç†åå° API
curl http://localhost:8000/api/connections/

# åº”è¯¥è¿”å›ï¼š[]
```

### è®¿é—®å‰ç«¯

- ç®¡ç†åå°ï¼šhttp://localhost:3000
- èŠå¤©ç•Œé¢ï¼šhttp://localhost:3001

---

## ğŸ›‘ åœæ­¢æœåŠ¡

### åœæ­¢ Docker æœåŠ¡

```bash
./start-services.sh stop
```

### åœæ­¢åç«¯æœåŠ¡

åœ¨è¿è¡Œ `admin_server.py` å’Œ `chat_server.py` çš„ç»ˆç«¯ä¸­æŒ‰ `Ctrl+C`

### åœæ­¢å‰ç«¯æœåŠ¡

åœ¨è¿è¡Œ `npm start` å’Œ `npm run dev` çš„ç»ˆç«¯ä¸­æŒ‰ `Ctrl+C`

---

## ğŸ”„ é‡å¯æœåŠ¡

### é‡å¯ Docker æœåŠ¡

```bash
./start-services.sh restart
```

### é‡å¯åç«¯æœåŠ¡

ç›´æ¥é‡æ–°è¿è¡Œï¼š
```bash
cd backend
python admin_server.py  # æˆ– python chat_server.py
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š`Address already in use`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :3306  # MySQL
lsof -i :5433  # PostgreSQL
lsof -i :8000  # ç®¡ç†åå°
lsof -i :8001  # èŠå¤©æœåŠ¡
lsof -i :3000  # å‰ç«¯ç®¡ç†åå°
lsof -i :3001  # å‰ç«¯èŠå¤©ç•Œé¢

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
kill -9 <PID>
```

### é—®é¢˜ 2: æ•°æ®åº“è¡¨ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯**ï¼š`Table 'chatdb.dbconnection' doesn't exist`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
cd backend
alembic upgrade head
```

### é—®é¢˜ 3: Docker å®¹å™¨å¯åŠ¨å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥çœ‹æ—¥å¿—
./start-services.sh logs

# æˆ–æŸ¥çœ‹ç‰¹å®šå®¹å™¨æ—¥å¿—
docker logs chat_to_db_rwx-mysql
docker logs chat_to_db_rwx-postgres-checkpointer
```

### é—®é¢˜ 4: å‰ç«¯æ— æ³•è¿æ¥åç«¯

**æ£€æŸ¥**ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆ8000 å’Œ 8001ï¼‰
3. æ£€æŸ¥ `frontend/admin/.env` å’Œ `frontend/chat/.env` é…ç½®

---

## ğŸ“š æ›´å¤šæ–‡æ¡£

- [Docker å¿«é€Ÿå¯åŠ¨æŒ‡å—](DOCKER_QUICK_START.md)
- [Docker æ›´æ–°å®ŒæˆæŠ¥å‘Š](DOCKER_æ›´æ–°å®Œæˆ.md)
- [æ•°æ®åº“è¿ç§»ä¿®å¤å®Œæˆ](æ•°æ®åº“è¿ç§»ä¿®å¤å®Œæˆ.md)
- [Docker éƒ¨ç½²æŒ‡å—](docs/deployment/DOCKER_DEPLOYMENT.md)
- [é¡¹ç›® README](README.md)

---

## ğŸ¯ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# Docker æœåŠ¡
./start-services.sh start        # å¯åŠ¨
./start-services.sh stop         # åœæ­¢
./start-services.sh restart      # é‡å¯
./start-services.sh status       # çŠ¶æ€
./start-services.sh logs         # æ—¥å¿—

# æ•°æ®åº“è¿ç§»
cd backend && alembic upgrade head

# åç«¯æœåŠ¡
cd backend && python admin_server.py  # ç®¡ç†åå°
cd backend && python chat_server.py   # èŠå¤©æœåŠ¡

# å‰ç«¯æœåŠ¡
cd frontend/admin && npm start        # ç®¡ç†åå°
cd frontend/chat && npm run dev       # èŠå¤©ç•Œé¢
```

---

**æœ€åæ›´æ–°**: 2026-01-18  
**çŠ¶æ€**: âœ… å·²éªŒè¯
